


## 11. 欧拉路径与欧拉回路
> 欧拉路径: 如果图 G 中的一条路径包括图中每条边恰好一次，则该路径被称为欧拉路径

> 欧拉回路：如果一个回路是欧拉路径，那么该路径被称为欧拉回路

1. 对于无向图，所有边都是连通的：
   - 存在欧拉路径的充分必要条件：度数为奇数的点为 0 个或 2 个
   - 存在欧拉回路的充分必要条件：度数为奇数的点只能为 0 个

2. 对于有向图，所有边都是连通的：
   - 存在欧拉路径的充分必要条件：要么所有点的出度等于入度；要么只有两个点的入度不等于出度，并且其中一个点的入度等于出度加一，另一个点的入度等于出度减一
   - 存在欧拉回路的充分必要条件：所有点的出度均等于入度


问题 1：如何记录欧拉回路（路径）？

hierholzers 算法和 fluery 算法

算法过程：(递归过程就是一笔画过程)
1. 选择任一顶点为起点，遍历所有邻边
2. dfs，访问相邻顶点，并将经过的边都删除
3. 如果当前顶点没有相邻边，则将顶点入栈
4. 栈中的顶点倒序输出，就是从起点出发的欧拉回路

```
# 邻接矩阵版本

dfs(cur): 
   for i in 所有顶点:
      if edge[cur][i] 存在边：
         删掉边 # 比如度数减一
         dfs(i)
   
   q.push(cur)
```
**并且得到的顶点顺序也是最小字典序**

如果要想要直接输出边：只需要将压栈动作放到 for 循环里面即可。

**为什么要删边？**

> 防止时间复杂度过高，因为是以边为标记。如果不删掉，对于某些情况，时间复杂度会达到 $O(m^2)$，比如**某个点有 m 条自环**。


### 应用
1. [acwing 1123. 铲雪车](https://www.acwing.com/problem/content/1125/)

题目分析：
1. 每条道路都是双向边
2. 起点一定能够遍历所有的边

因此我们可以得出两点：
1. 所有边是连通的
2. 所有点的入度等于出度

因此，此图中存在一条欧拉回路。能够一次性遍历所有的边。题目要求最短时间，也就是求遍历完所有边的最短时间，也就是所有边的长度即可，无需建图。

**注意四舍五入的精度问题，计算机浮点数存储的问题**

2. [acwing 1184. 欧拉回路](https://www.acwing.com/problem/content/1186/)

本题需要输出欧拉路径或回路（并且是按照边的编号输出）。由于 test case 比较多，需要做语言上的优化

3. [acwing 1124. 骑马修栅栏](https://www.acwing.com/problem/content/1126/)

4. [acwing 1185. 单词游戏](https://www.acwing.com/problem/content/1187/)

题目分析：

因为单词数量达到 $10^5$ 级别，如果根据末尾字母和每个单词的首字母相连，那么最坏情况边的数量能够达到 $10^{10}$。比如每个单词的首尾字母都相同。

那么，我们可以采用另外一种建边技巧。直接将每个单词当做一条边，顶点为首尾字母。如果使用邻接表，那么就只会有 $10^5$ 条边；如果使用邻接矩阵，那么只会有 $26*26$ 条边。

题目问是否能够将所有单词根据题目的性质排列成一行。也就是等价于：
我们是否能够从某个点出发，遍历完所有边，也就是求所建的图中是否存在欧拉路径。

本图是一个有向图，由于判断是否存在欧拉路径
1. 判断入度和出度即可，因此我们无需建立边。直接遍历即可。
2. 判断所有的边是否连通
   - 建图后，dfs，判断遍历边的数量是否和总边数相等
   - 并查集 - 看**存在边**的顶点是否在一个集合。这里虽然是有向图，但是仍然能够使用并查集，是因为我们已经在第一步判断过入度和出度了，也就意味着最多只有两个点入度和出度不等，其他所有点都是一进一出。表示能够访问对应的点，一定能够遍历完由这些点发出的边。所以能够使用并查集。