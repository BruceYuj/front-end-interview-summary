<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>BY 的前端笔记</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="a repo about notes">
    <meta name="theme-color" content="#ffffff">
    <link rel="preload" href="/front-end-interview-summary/assets/css/0.styles.4db39399.css" as="style"><link rel="preload" href="/front-end-interview-summary/assets/js/app.9251b7d9.js" as="script"><link rel="preload" href="/front-end-interview-summary/assets/js/2.9b343076.js" as="script"><link rel="preload" href="/front-end-interview-summary/assets/js/43.9f419b40.js" as="script"><link rel="preload" href="/front-end-interview-summary/assets/js/12.db4bb610.js" as="script"><link rel="prefetch" href="/front-end-interview-summary/assets/js/10.64b2fcdc.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/11.08ed2bab.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/13.c3214b20.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/14.db8f4284.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/15.8f5b33d4.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/16.26503476.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/17.accb64c4.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/18.cff214dd.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/19.67f30ff6.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/20.4bac9835.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/21.50f12972.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/22.8560d777.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/23.11467882.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/24.63bc8234.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/25.61dc613f.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/26.6eafbd04.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/27.d46b5b40.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/28.8d5895eb.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/29.73cfd4ff.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/3.a9374cea.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/30.88a53c68.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/31.327f5256.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/32.90e39e30.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/33.b8c6d735.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/34.865dc524.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/35.e301318e.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/36.c466c515.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/37.e27bb783.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/38.49a1d44a.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/39.377c3e39.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/4.b3dbefe1.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/40.0ee482bd.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/41.71f3f83a.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/42.60e45a1e.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/44.89e319c6.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/45.d49fe915.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/46.49036315.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/47.a854d2a1.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/48.670e01a8.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/49.c2a04f51.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/5.7c69718c.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/50.015399d9.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/51.6a6c89bf.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/52.4f94e55f.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/53.d1844d29.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/54.345b43ac.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/55.14a9f816.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/56.1303bf8c.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/6.a70c724c.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/7.3b248faf.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/8.e652da83.js"><link rel="prefetch" href="/front-end-interview-summary/assets/js/9.86e9bcf5.js">
    <link rel="stylesheet" href="/front-end-interview-summary/assets/css/0.styles.4db39399.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/front-end-interview-summary/" class="home-link router-link-active"><!----> <span class="site-name">BY 的前端笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/front-end-interview-summary/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络" class="dropdown-title"><span class="title">网络</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/network/http/" class="nav-link">
  HTTP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/front-end/browser/" class="nav-link">
  浏览器
</a></li><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/front-end/JavaScript/" class="nav-link router-link-active">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/front-end/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/front-end/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/front-end/Mom-I-Cant-Learn-Anymore/" class="nav-link">
  《妈妈，我学不动了》
</a></li><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/front-end/front-end-thinking/" class="nav-link">
  《前端思考录》
</a></li></ul></div></div><div class="nav-item"><a href="/front-end-interview-summary/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="系统设计" class="dropdown-title"><span class="title">系统设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/system-design/why-is-the-design/" class="nav-link">
  《为什么这么设计》
</a></li></ul></div></div><div class="nav-item"><a href="/front-end-interview-summary/thinking-more/" class="nav-link">
  独立思考屋
</a></div> <a href="https://github.com/BruceYuj/front-end-interview-summary" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/front-end-interview-summary/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络" class="dropdown-title"><span class="title">网络</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/network/http/" class="nav-link">
  HTTP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/front-end/browser/" class="nav-link">
  浏览器
</a></li><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/front-end/JavaScript/" class="nav-link router-link-active">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/front-end/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/front-end/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/front-end/Mom-I-Cant-Learn-Anymore/" class="nav-link">
  《妈妈，我学不动了》
</a></li><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/front-end/front-end-thinking/" class="nav-link">
  《前端思考录》
</a></li></ul></div></div><div class="nav-item"><a href="/front-end-interview-summary/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="系统设计" class="dropdown-title"><span class="title">系统设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end-interview-summary/system-design/why-is-the-design/" class="nav-link">
  《为什么这么设计》
</a></li></ul></div></div><div class="nav-item"><a href="/front-end-interview-summary/thinking-more/" class="nav-link">
  独立思考屋
</a></div> <a href="https://github.com/BruceYuj/front-end-interview-summary" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MODULAR-PROGRAMMING</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end-interview-summary/front-end/JavaScript/modular-programming/es-module.html" class="sidebar-link">/front-end/JavaScript/modular-programming/es-module.html</a></li><li><a href="/front-end-interview-summary/front-end/JavaScript/modular-programming/evolution-of-js-modularity-1.html" aria-current="page" class="active sidebar-link">/front-end/JavaScript/modular-programming/evolution-of-js-modularity-1.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-interview-summary/front-end/JavaScript/modular-programming/evolution-of-js-modularity-1.html#_1999-directly-defined-dependencies" class="sidebar-link">1999 - Directly Defined Dependencies</a></li><li class="sidebar-sub-header"><a href="/front-end-interview-summary/front-end/JavaScript/modular-programming/evolution-of-js-modularity-1.html#_2002-namespace-pattern" class="sidebar-link">2002 - namespace pattern</a></li><li class="sidebar-sub-header"><a href="/front-end-interview-summary/front-end/JavaScript/modular-programming/evolution-of-js-modularity-1.html#_2003-module-pattern" class="sidebar-link">2003 - module pattern</a></li><li class="sidebar-sub-header"><a href="/front-end-interview-summary/front-end/JavaScript/modular-programming/evolution-of-js-modularity-1.html#template-defined-dependencies-2006" class="sidebar-link">template defined Dependencies(2006)</a></li><li class="sidebar-sub-header"><a href="/front-end-interview-summary/front-end/JavaScript/modular-programming/evolution-of-js-modularity-1.html#reference" class="sidebar-link">reference</a></li></ul></li><li><a href="/front-end-interview-summary/front-end/JavaScript/modular-programming/modular-programming-introduction.html" class="sidebar-link">/front-end/JavaScript/modular-programming/modular-programming-introduction.html</a></li><li><a href="/front-end-interview-summary/front-end/JavaScript/modular-programming/node-commonjs-module.html" class="sidebar-link">reference</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p><strong>文本更新于 2020年04月21日 18:11:49</strong></p> <h2 id="_1999-directly-defined-dependencies"><a href="#_1999-directly-defined-dependencies" class="header-anchor">#</a> 1999 - Directly Defined Dependencies</h2> <p>直接定义依赖模式是由 Erik Arvidsson（TC39 成员之一） 在 1999 年首次提出。后面 Dojo toolkit 在 2004 也实现了该模式，我们通过 dojo 来举个例子：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// file greeting.js</span>
dojo<span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&quot;app.greeting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span>greeting<span class="token punctuation">.</span>helloInLang <span class="token operator">=</span> <span class="token punctuation">{</span>
    en<span class="token operator">:</span> <span class="token string">'Hello world!'</span><span class="token punctuation">,</span>
    es<span class="token operator">:</span> <span class="token string">'¡Hola mundo!'</span><span class="token punctuation">,</span>
    cn<span class="token operator">:</span> <span class="token string">'你好 世界！'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span>greeting<span class="token punctuation">.</span><span class="token function-variable function">sayHello</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">lang</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> app<span class="token punctuation">.</span>greeting<span class="token punctuation">.</span>helloInLang<span class="token punctuation">[</span>lang<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// file hello.js</span>
dojo<span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&quot;app.hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

dojo<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'app.greeting'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function-variable function">hello</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>greeting<span class="token punctuation">.</span><span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token string">'es'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>在 dojo 当中，我们使用 <code>dojo.provide</code> 方法来定义模块，而通过 <code>dojo.require</code> 来使用模块。这种方式在于没有将模块和文件相关联，也就是说，在这种模式下，我们可以在一个文件里面定义多个模块。</p> <h2 id="_2002-namespace-pattern"><a href="#_2002-namespace-pattern" class="header-anchor">#</a> 2002 - namespace pattern</h2> <p>在 JavaScript，为了解决 name collision，我们有什么解决方案呢？</p> <ol><li>通过编程惯例来约束。我们可以将同类的 variables 和 functions 标识符前面加上共同的前缀来表示这些 objects 是一类的（比如 <code>app_</code>）。这种做法非常类似于 python 中通过下划线约定私有变量（比如<code>__init</code>）。但是这种方式引入了新的问题：这些前缀该如何定义呢？如何确保这些前缀不冲突呢？</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// file app.js</span>
<span class="token keyword">var</span> app_helloInLang <span class="token operator">=</span> <span class="token punctuation">{</span>
    en<span class="token operator">:</span> <span class="token string">'hello World!'</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">app_writeHello</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">lang</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>app_helloInLang<span class="token punctuation">[</span>lang<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>每个模块都对应着一个 global object，利用 JavaScript 中函数是一等公民的特性，将同个模块的变量和方法都作为属性添加到这个 global object 当中，来达到避免 name collision 的目的。而这种模式被称为 <code>namespace pattern</code>。</li></ol> <blockquote><p>What is namespace? namespace是用来放置 identifiers, functions, methods 的容器，这个容器允许我们通过该容器来访问里面的内容。</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// file app.js</span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// file greeting.js</span>
app<span class="token punctuation">.</span>helloInLang <span class="token operator">=</span> <span class="token punctuation">{</span>
    en<span class="token operator">:</span> <span class="token string">'Hello world!'</span><span class="token punctuation">,</span>
    es<span class="token operator">:</span> <span class="token string">'¡Hola mundo!'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// file hello.js</span>
app<span class="token punctuation">.</span><span class="token function-variable function">writeHello</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">lang</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>helloInLang<span class="token punctuation">[</span>lang<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>namespace pattern 是非常出名的一种模式，最初来自于 Erik Arvidsson 在 2002 的 Bindow ，后面很多的 framework 和 library 当中都有使用，比如 Dojo(2005)/YUI(2005)。</p> <h2 id="_2003-module-pattern"><a href="#_2003-module-pattern" class="header-anchor">#</a> 2003 - module pattern</h2> <p>尽管 namespace pattern 在某种程度上解决了 global namespace pollution(全局命名空间污染) 问题，给代码带来了部分有序性，但是这种改进并不彻底。</p> <p>对于 namespace pattern 来讲，function 和 data 是混在一起的，而对于一个真正的模块，很多时候我们需要隐藏掉内部的数据，而只暴露操作内部数据的方法。</p> <p>module pattern 则是尝试解决该问题的先驱。它的要点是通过 closure 来封装 data 和 code，外界只能通过有限的方式访问数据：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> greeting <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 存放可以被外部访问的</span>

    <span class="token keyword">var</span> helloInLang <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">// 表示不可以被外部直接访问</span>
        en<span class="token operator">:</span> <span class="token string">'Hello world!'</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    module<span class="token punctuation">.</span><span class="token function-variable function">getHello</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">lang</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> helloInLang<span class="token punctuation">[</span>lang<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    module<span class="token punctuation">.</span><span class="token function-variable function">writeHello</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">lang</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span><span class="token function">getHello</span><span class="token punctuation">(</span>lang<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> module<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这里使用了 IIFE（immediately invoked function）来返回一个 module object。这种方式带来了两个好处：</p> <ul><li>给代码赋予原子性，可以确保在外界无法直接访问 module 中的数据</li> <li>利用 function scope 解决了 name collision</li></ul> <p>这种方式，首先由 Richard Cornford 在 2003 年使用，但其广为流传则是由于 Douglas Crockford 在 2008 年写的书《JavaScript: the Good Parts》 和 YUI(Eric Miraglia 在 2007 年的blog) 。尽管在 2020 年的当下，我们已经有了更加健壮的模块化方案，但是理解 module pattern 仍然尤其意义所在。如果研究 webpack 比较透彻的话，你会发现 module pattern 的影子无处不在。</p> <blockquote><p>正所谓，“虽然世上已无我的身影，但我却无处不在”</p></blockquote> <h3 id="module-pattern-in-depth"><a href="#module-pattern-in-depth" class="header-anchor">#</a> module pattern - in depth</h3> <p>本小节，更加深入的探讨下 module pattern 的使用。</p> <p>对于 module pattern 来讲，其中一个限制就是整个 module 必须在一个文件当中，而某些时候我们希望在不同的文件中不断增强这个 module。</p> <p>为什么需要呢？
因为我们可能由于 code split 的原因而操作同一个 module。</p> <p>此时我们可以采用如下的方式：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token constant">MODULE</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">my</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    my<span class="token punctuation">.</span><span class="token function-variable function">anotherMethod</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> my<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token constant">MODULE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>如此，我们就通过增强的方式给 MODULE 添加了一个新的方法，并且该增强的文件仍然可以维护自己的内部状态(internal state) 和 imports。</p> <p><strong>上面的写法是否有问题呢？</strong></p> <p>对于浏览器端来讲，我们为了性能，会非常希望能够异步的加载 js 文件（像 LABjs 一样），而这带来的问题是我们无法预知哪个js文件会被 最先加载。如果 initial module 的文件没有被最先加载的话，那么 MODULE 就等于 <code>undefined</code>，也就不是我们想要的结果了。
因此，我们可以采用 <code>loose augmentation</code> 的写法：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token constant">MODULE</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">my</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">return</span> my<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token constant">MODULE</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>有时候解决了一个问题却引入了多个新的问题。</p></blockquote> <p>异步带来了新的问题：覆盖的无序性。有时候旧的会覆盖新的。此时我们可以采用 <code>tight augmentation</code>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token constant">MODULE</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">my</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> old_moduleMethod <span class="token operator">=</span> my<span class="token punctuation">.</span>moduleMethod<span class="token punctuation">;</span>

	my<span class="token punctuation">.</span><span class="token function-variable function">moduleMethod</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// method override, has access to old through old_moduleMethod...</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> my<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token constant">MODULE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="template-defined-dependencies-2006"><a href="#template-defined-dependencies-2006" class="header-anchor">#</a> template defined Dependencies(2006)</h2> <h2 id="reference"><a href="#reference" class="header-anchor">#</a> reference</h2> <ol><li><a href="http://blog.calyptus.eu/seb/2011/10/choosing-a-javascript-module-syntax/" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/myshov/history-of-javascript/blob/master/4_evolution_of_js_modularity/README.md" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/BruceYuj/front-end-interview-summary/edit/master/docs/front-end/JavaScript/modular-programming/evolution-of-js-modularity-1.md" target="_blank" rel="noopener noreferrer">在 Github 上改善此页面</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">7/2/2020, 9:07:30 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/front-end-interview-summary/front-end/JavaScript/modular-programming/es-module.html" class="prev">
        /front-end/JavaScript/modular-programming/es-module.html
      </a></span> <span class="next"><a href="/front-end-interview-summary/front-end/JavaScript/modular-programming/modular-programming-introduction.html">
        /front-end/JavaScript/modular-programming/modular-programming-introduction.html
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/front-end-interview-summary/assets/js/app.9251b7d9.js" defer></script><script src="/front-end-interview-summary/assets/js/2.9b343076.js" defer></script><script src="/front-end-interview-summary/assets/js/43.9f419b40.js" defer></script><script src="/front-end-interview-summary/assets/js/12.db4bb610.js" defer></script>
  </body>
</html>
